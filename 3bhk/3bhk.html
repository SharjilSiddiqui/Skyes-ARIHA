<!DOCTYPE html>
<html>

<head>
    <title>3 Bhk</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
    <link rel="manifest" href="/assets/site.webmanifest">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, width=device-width, viewport-fit=cover, maximum-scale=1.0" />

    <link rel="preload" href="script.js?v=1755676325278" as="script" />
    <link rel="preload" href="media/panorama_C8E22910_C38F_897E_41BD_C3761AC35EAF_0/l/2/0_0.jpg?v=1755676325278"
        as="image" />
    <link rel="preload" href="media/panorama_C8E22910_C38F_897E_41BD_C3761AC35EAF_0/r/2/0_0.jpg?v=1755676325278"
        as="image" />
    <link rel="preload" href="media/panorama_C8E22910_C38F_897E_41BD_C3761AC35EAF_0/u/2/0_0.jpg?v=1755676325278"
        as="image" />
    <link rel="preload" href="media/panorama_C8E22910_C38F_897E_41BD_C3761AC35EAF_0/d/2/0_0.jpg?v=1755676325278"
        as="image" />
    <link rel="preload" href="media/panorama_C8E22910_C38F_897E_41BD_C3761AC35EAF_0/f/2/0_0.jpg?v=1755676325278"
        as="image" />
    <link rel="preload" href="media/panorama_C8E22910_C38F_897E_41BD_C3761AC35EAF_0/b/2/0_0.jpg?v=1755676325278"
        as="image" />

    <script>(function (i, s, o, g, r, a, m) { i["GoogleAnalyticsObject"] = r; i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o), m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m) })(window, document, "script", "//www.google-analytics.com/analytics.js", "ga"); ga("create", "UA-116087-3", "auto"); ga("send", "pageview");</script>
    <meta name="description" content="Virtual Tour" />
    <meta name="theme-color" content="#FFFFFF" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <script src="lib/tdvplayer.js?v=1755676325278"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style type="text/css">
        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
        }

        #viewer {
            background-color: #FFFFFF;
            z-index: 1;
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
        }

        #preloadContainer {
            z-index: 2;
            position: relative;
            width: 100%;
            height: 100%;
            transition: opacity 0.5s;
            -webkit-transition: opacity 0.5s;
            -moz-transition: 0.5s;
            -o-transition: 0.5s;
        }

        /* Floor buttons - vertical left */
        #floorNav {
            position: absolute;
            top: 50%;
            left: 16px;
            transform: translateY(-50%);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 12px;
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
            background-color: transparent;
        }

        #floorNav button {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            background: #8a1a52;
            color: #fff;
            font-weight: 700;
            box-shadow: 0 6px 18px rgba(0,0,0,0.2);
            transition: transform 0.15s ease, background 0.2s ease, box-shadow 0.2s ease;
        }

        #floorNav button:hover { transform: translateY(-2px); box-shadow: 0 10px 24px rgba(0,0,0,0.25); }
        #floorNav button.active { background: #a11f60; }
        #floorNav button:disabled { opacity: 0.6; cursor: not-allowed; }

        /* Bottom room bar */
        #roomNav {
            position: absolute;
            left: 50%;
            bottom: 16px;
            transform: translateX(-50%);
            z-index: 1000;
            display: flex;
            gap: 8px;
            /* background: rgba(255,255,255,0.9); */
            padding: 8px 12px;
            border-radius: 16px;
            /* box-shadow: 0 6px 18px rgba(0,0,0,0.15); */
        }

        #roomNav button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            border: none;
            background: #8a1a52;
            color: #fff;
            padding: 8px 12px;
            border-radius: 999px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s ease;
        }
        #roomNav button:hover { background: #a11f60; }

        /* Top-right actions */
        #topActions {
            position: absolute;
            top: 16px;
            right: 16px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }
        #topActions button {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            background: #8a1a52;
            color: #fff;
            cursor: pointer;
            box-shadow: 0 6px 18px rgba(0,0,0,0.2);
            transition: transform 0.15s ease, background 0.2s ease;
        }
        #topActions button:hover { transform: translateY(-1px); background: #a11f60; }

        #floorNav button.debug {
            background: #666 !important;
            font-size: 12px;
            padding: 6px 8px;
        }

        /* Current room indicator */
        #currentRoomInfo {
            position: absolute;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 999;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        #currentRoomInfo.show {
            opacity: 1;
        }

        /* Rotate Overlay */
        #rotateOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            font-family: 'Segoe UI', sans-serif;
            font-size: 1.5rem;
            z-index: 999999;
            text-align: center;
            padding: 20px;
            display: none;
        }

        #rotateOverlay i {
            font-size: 3rem;
            margin-bottom: 15px;
            animation: rotatePhone 2s infinite ease-in-out;
        }

        @keyframes rotatePhone {
            0% {
                transform: rotate(0deg);
            }

            50% {
                transform: rotate(90deg);
            }

            100% {
                transform: rotate(0deg);
            }
        }

        /* --- Updated Mobile Styles --- */
        
        /* For screens up to 768px */
        @media (max-width: 768px) {
            #floorNav {
                top: 50%;
                left: 8px;
                gap: 8px;
            }

            #floorNav button {
                width: 30px; /* Further reduced size */
                height: 30px;
                font-size: 0.65rem; /* Further reduced font size */
            }

            #roomNav {
                bottom: 8px;
                gap: 5px;
                padding: 4px 8px;
            }

            #roomNav button {
                padding: 4px 8px;
                font-size: 8px; /* Further reduced font size */
                gap: 6px;
            }

            #topActions {
                top: 8px;
                right: 8px;
                gap: 8px;
            }

            #topActions button {
                width: 28px; /* Further reduced size */
                height: 28px;
                font-size: 0.8rem; /* Further reduced icon font size */
            }
        }

        /* For screens between 769px and 1000px */
        @media (min-width: 769px) and (max-width: 1000px) {
            #floorNav {
                left: 12px;
                gap: 10px;
            }

            #floorNav button {
                width: 38px; /* Further reduced size */
                height: 38px;
                font-size: 0.75rem; /* Further reduced font size */
            }

            #roomNav {
                bottom: 12px;
                gap: 6px;
                padding: 5px 9px;
            }

            #roomNav button {
                padding: 5px 9px;
                font-size: 10px; /* Further reduced font size */
                gap: 7px;
            }

            #topActions {
                top: 12px;
                right: 12px;
                gap: 9px;
            }

            #topActions button {
                width: 32px; /* Further reduced size */
                height: 32px;
                font-size: 0.9rem; /* Further reduced icon font size */
            }
        }
    </style>

    <script type="text/javascript">
    var player;
    var playersPlayingTmp = [];
    var isInitialized = false;
    var isPaused = false;

    // The scenes object remains the same as provided.
    var SCENES = {
        // '17th': {
        //     entrance: '3bhk 02 entrance 17th floor',
        //     hall: '3bhk 01 hall 17th floor',
        //     passage: '3bhk Passage 17th floor',
        //     kitchen: '3bhk kitchen',
        //     bedroom01_1: '3bhk bedroom02 17th',
        //     bedroom01_2: '3bhk bedroom01 17th',
        //     bedroom02_1: '3bhk bedroom02 2 17th',
        //     bedroom02_2: '3bhk bedroom02 1 17th',
        //     bedroom03_1: '3bhk bedroom03 01 17th',
        //     bedroom03_2: '3bhk bedroom03 02 17th',
        //     balcony: '3BHK_Bolcony_17',
        //     bedroom1_toilet: '3bhk_bedroom01_toilet copy',
        //     bedroom2_toilet: '3bhk_bed2_toilet copy',
        //     bedroom3_toilet: '3bhk_BDRoom03_toilet copy',
        // },
        '17th': {
            entrance: '3bhk 02 entrance 23rd floor',
            hall: '3bhk 01 hall 23rd floor',
            passage: '3bhk Passage 23rd floor',
            kitchen: '3bhk kitchen',
            bedroom01_1: '3bhk bedroom02 23rd',
            bedroom01_2: '3bhk bedroom01 23rd',
            bedroom02_1: '3bhk bedroom02 2 23rd',
            bedroom02_2: '3bhk bedroom02 1 23rd',
            bedroom03_1: '3bhk bedroom03 01 23rd',
            bedroom03_2: '3bhk bedroom03 02 23rd',
            balcony: '3BHK_Bolcony_23',
            bedroom1_toilet: '3bhk_bedroom01_toilet copy',
            bedroom2_toilet: '3bhk_bed2_toilet copy',
            bedroom3_toilet: '3bhk_BDRoom03_toilet copy',
        },
        // '23rd': {
        //     entrance: '3bhk 02 entrance 23rd floor',
        //     hall: '3bhk 01 hall 23rd floor',
        //     passage: '3bhk Passage 23rd floor',
        //     kitchen: '3bhk kitchen',
        //     bedroom01_1: '3bhk bedroom02 23rd',
        //     bedroom01_2: '3bhk bedroom01 23rd',
        //     bedroom02_1: '3bhk bedroom02 2 23rd',
        //     bedroom02_2: '3bhk bedroom02 1 23rd',
        //     bedroom03_1: '3bhk bedroom03 01 23rd',
        //     bedroom03_2: '3bhk bedroom03 02 23rd',
        //     balcony: '3BHK_Bolcony_23',
        //     bedroom1_toilet: '3bhk_bedroom01_toilet copy',
        //     bedroom2_toilet: '3bhk_bed2_toilet copy',
        //     bedroom3_toilet: '3bhk_BDRoom03_toilet copy',
        // },
        '25th': {
            entrance: '3bhk 02 entrance 28th floor',
            hall: '3bhk 01 hall 28th floor',
            passage: '3bhk Passage 28th floor',
            kitchen: '3bhk kitchen',
            bedroom01_1: '3bhk bedroom02 28th',
            bedroom01_2: '3bhk bedroom01 28th',
            bedroom02_1: '3bhk bedroom02 2 28th',
            bedroom02_2: '3bhk bedroom02 1 28th',
            bedroom03_1: '3bhk bedroom03 01 28th',
            bedroom03_2: '3bhk bedroom03 02 28th',
            balcony: '3BHK_Bolcony_28',
            bedroom1_toilet: '3bhk_bedroom01_toilet copy',
            bedroom2_toilet: '3bhk_bed2_toilet copy',
            bedroom3_toilet: '3bhk_BDRoom03_toilet copy',
        },
        '33rd': {
            entrance: '3bhk 02 entrance 33rd floor',
            hall: '3bhk 01 hall 33rd floor',
            passage: '3bhk Passage 33rd floor',
            kitchen: '3bhk kitchen',
            bedroom01_1: '3bhk bedroom02 33rd',
            bedroom01_2: '3bhk bedroom01 33rd',
            bedroom02_1: '3bhk bedroom02 2 33rd',
            bedroom02_2: '3bhk bedroom02 1 33rd',
            bedroom03_1: '3bhk bedroom03 01 106th',
            bedroom03_2: '3bhk bedroom03 02 106th',
            balcony: '3BHK_Bolcony_33',
            bedroom1_toilet: '3bhk_bedroom01_toilet copy',
            bedroom2_toilet: '3bhk_bed2_toilet copy',
            bedroom3_toilet: '3bhk_BDRoom03_toilet copy',
        }
    };

    var currentFloor = "17th";
    var currentRoom = "";


    // Removed legacy viewer scenechange handler; use TDV player events instead

    // **FIXED:** The logic now refreshes the state before processing the switch.
    function switchFloor(targetFloor) {
        if (!isInitialized || !player) {
            console.warn('Player not ready for floor switch');
            return;
        }

        // 1. Get the current, actual scene name to ensure state is fresh.
        var currentSceneLabel = getCurrentSceneName();
        if (!currentSceneLabel) {
            console.error('Could not get current scene name. Aborting floor switch.');
            return;
        }

        // 2. Use the real scene name to get the correct current room and floor.
        currentRoom = getRoomKeyFromSceneLabel(currentSceneLabel);
        currentFloor = getFloorFromSceneLabel(currentSceneLabel);
        highlightActiveFloorButton(currentFloor);

        // Check if the requested floor is the same as the current floor after the refresh.
        if (targetFloor === currentFloor) {
            console.log('Already on floor', targetFloor);
            return;
        }

        console.log('Initiating floor switch from', currentFloor, 'to', targetFloor, 'keeping room', currentRoom);

        var targetScenes = SCENES[targetFloor];
        var targetSceneName = null;

        // Try to find the target scene for the current room key.
        if (currentRoom && targetScenes && targetScenes[currentRoom]) {
            targetSceneName = targetScenes[currentRoom];
            console.log('Found scene persistence match for room:', currentRoom, '->', targetSceneName);
        } else {
            // Fallback to entrance if the room doesn't exist on the target floor.
            console.warn('Room', currentRoom, 'not found on floor', targetFloor, '. Defaulting to entrance.');
            targetSceneName = SCENES[targetFloor]['entrance'];
            currentRoom = 'entrance';
        }

        if (!targetSceneName) {
            console.error('Failed to find a valid target scene. Aborting floor switch.');
            return;
        }

        // Disable buttons during transition
        var buttons = document.querySelectorAll('#floorNav button');
        buttons.forEach(function(btn) { btn.disabled = true; });

        // Switch to the target scene
        var result = setMediaByName(targetSceneName);
        if (result) {
            console.log('Successfully requested scene switch to:', targetSceneName);
            // The event listener will update currentFloor again when the scene loads.
            
            // Re-enable buttons after a short delay
            setTimeout(function() {
                buttons.forEach(function(btn) { btn.disabled = false; });
            }, 500);
        } else {
            console.error('setMediaByName failed for:', targetSceneName);
            // Re-enable buttons if the switch failed
            buttons.forEach(function(btn) { btn.disabled = false; });
        }
    }

    // Debug function to test scene persistence
    function debugScenePersistence() {
        console.log('=== SCENE PERSISTENCE DEBUG ===');
        console.log('Current Floor:', currentFloor);
        console.log('Current Room:', currentRoom);
        console.log('Current Scene Name:', getCurrentSceneName());
        console.log('Available Floors:', Object.keys(SCENES));
        console.log('Available Rooms on Current Floor:', Object.keys(SCENES[currentFloor]));
        console.log('===============================');
        
        // Force refresh tracking
        console.log('Forcing tracking refresh...');
        updateTracking();
        console.log('Tracking refreshed - Floor:', currentFloor, 'Room:', currentRoom);
        
        // Log all available scenes
        logAllScenes();
    }

    // Manual function to set current scene state (for testing)
    function setCurrentSceneState(floor, room) {
        if (SCENES[floor] && SCENES[floor][room]) {
            currentFloor = floor;
            currentRoom = room;
            console.log('Manually set scene state - Floor:', currentFloor, 'Room:', currentRoom);
            highlightActiveFloorButton(currentFloor);
            saveSceneState();
            updateCurrentRoomIndicator();
        } else {
            console.error('Invalid floor/room combination:', floor, room);
        }
    }

    // Test scene persistence function
    function testScenePersistence() {
        console.log('=== TESTING SCENE PERSISTENCE ===');
        
        // Test 1: Switch to bedroom01 on 17th floor
        console.log('Test 1: Setting to bedroom01 on 17th floor');
        setCurrentSceneState('17th', 'bedroom01');
        
        setTimeout(function() {
            // Test 2: Switch to 25th floor
            console.log('Test 2: Switching to 25th floor');
            switchFloor('25th');
            
            setTimeout(function() {
                // Test 3: Check if we're in bedroom01 on 25th floor
                console.log('Test 3: Verifying we are in bedroom01 on 25th floor');
                var currentScene = getCurrentSceneName();
                console.log('Current scene:', currentScene);
                console.log('Expected scene:', SCENES['25th']['bedroom01']);
                console.log('Test result:', currentScene === SCENES['25th']['bedroom01'] ? 'PASSED' : 'FAILED');
            }, 1000);
        }, 1000);
    }

    // Test floor switching with different room types
    function testFloorSwitching() {
        console.log('=== TESTING FLOOR SWITCHING ===');
        
        var testRooms = ['entrance', 'hall', 'kitchen', 'bedroom01', 'bedroom02'];
        var testFloors = ['17th', '23rd', '28th', '33rd'];
        
        testRooms.forEach(function(room, roomIndex) {
            setTimeout(function() {
                console.log(`Testing room: ${room}`);
                setCurrentSceneState('17th', room);
                
                setTimeout(function() {
                    testFloors.forEach(function(floor, floorIndex) {
                        if (floor !== '17th') {
                            setTimeout(function() {
                                console.log(`Switching from ${room} on 17th to ${floor}`);
                                switchFloor(floor);
                                
                                setTimeout(function() {
                                    var currentScene = getCurrentSceneName();
                                    var expectedScene = SCENES[floor][room];
                                    console.log(`Result for ${room} -> ${floor}:`, 
                                        currentScene === expectedScene ? 'PASSED' : 'FAILED');
                                    console.log(`  Expected: ${expectedScene}`);
                                    console.log(`  Got: ${currentScene}`);
                                }, 1000);
                            }, (floorIndex - 1) * 2000);
                        }
                    });
                }, 1000);
            }, roomIndex * 8000);
        });
    }

    // Log all available scenes for debugging
    function logAllScenes() {
        console.log('=== ALL AVAILABLE SCENES ===');
        Object.keys(SCENES).forEach(function(floor) {
            console.log(floor + ' Floor:');
            Object.keys(SCENES[floor]).forEach(function(room) {
                console.log('  ' + room + ': ' + SCENES[floor][room]);
            });
        });
        console.log('===========================');
    }

    // Manually detect and set current room type from scene name
    function detectAndSetCurrentRoom() {
        var sceneName = getCurrentSceneName();
        if (sceneName) {
            console.log('Detecting room type from scene:', sceneName);
            var roomType = getRoomFromSceneName(sceneName);
            var floorType = getFloorFromSceneName(sceneName);
            
            if (roomType && floorType) {
                currentRoom = roomType;
                currentFloor = floorType;
                console.log('Detected and set - Floor:', currentFloor, 'Room:', currentRoom);
                highlightActiveFloorButton(currentFloor);
                saveSceneState();
                updateCurrentRoomIndicator();
                return true;
            }
        }
        console.log('Failed to detect room type');
        return false;
    }

    // Navigate to a specific scene
    function navigateToScene(floor, room) {
        if (SCENES[floor] && SCENES[floor][room]) {
            console.log('Navigating to:', floor, room, SCENES[floor][room]);
            var result = setMediaByName(SCENES[floor][room]);
            if (result) {
                currentFloor = floor;
                currentRoom = room;
                highlightActiveFloorButton(currentFloor);
                saveSceneState();
                updateCurrentRoomIndicator();
                console.log('Navigation successful');
            } else {
                console.error('Navigation failed');
            }
        } else {
            console.error('Invalid floor/room combination:', floor, room);
        }
    }

    // Save current scene state to localStorage
    function saveSceneState() {
        try {
            var state = {
                floor: currentFloor,
                room: currentRoom,
                timestamp: Date.now()
            };
            localStorage.setItem('sceneState', JSON.stringify(state));
            console.log('Scene state saved:', state);
        } catch (e) {
            console.warn('Failed to save scene state:', e);
        }
    }

    // Load scene state from localStorage
    function loadSceneState() {
        try {
            var state = localStorage.getItem('sceneState');
            if (state) {
                var parsed = JSON.parse(state);
                // Only restore if the state is not too old (24 hours)
                if (Date.now() - parsed.timestamp < 24 * 60 * 60 * 1000) {
                    currentFloor = parsed.floor;
                    currentRoom = parsed.room;
                    console.log('Scene state restored:', parsed);
                    return true;
                }
            }
        } catch (e) {
            console.warn('Failed to load scene state:', e);
        }
        return false;
    }

    // Setup keyboard shortcuts for floor navigation
    function setupKeyboardShortcuts() {
        document.addEventListener('keydown', function(e) {
            // Only handle shortcuts when not typing in input fields
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
            
            switch(e.key) {
                case '1':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        switchFloor('17th');
                    }
                    break;
                case '2':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        switchFloor('23rd');
                    }
                    break;
                case '3':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        switchFloor('25th');
                    }
                    break;
                case '4':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        switchFloor('33rd');
                    }
                    break;
                case 'd':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        debugScenePersistence();
                    }
                    break;
            }
        });
        console.log('Keyboard shortcuts setup complete');
    }

    // Update current room indicator
    function updateCurrentRoomIndicator() {
        var indicator = document.getElementById('currentRoomInfo');
        if (!indicator) return;
        
        var roomDisplayName = currentRoom.replace(/([A-Z])/g, ' $1').replace(/^./, function(str){ return str.toUpperCase(); });
        var floorDisplayName = currentFloor;
        
        indicator.textContent = floorDisplayName + ' Floor - ' + roomDisplayName;
        indicator.classList.add('show');
        
        // Hide after 3 seconds
        setTimeout(function() {
            indicator.classList.remove('show');
        }, 3000);
    }

    // **MODIFIED:** Removed buttons for balcony and toilets
    function buildRoomNavBar() {
        var container = document.getElementById('roomNav');
        if (!container) return;
        container.innerHTML = '';

        // Define display order and labels
        var entries = [
            { key: 'entrance', label: 'Entrance', icon: 'fa-person-booth' },
            { key: 'hall', label: 'Living Room', icon: 'fa-couch' },
            { key: 'passage', label: 'Passage', icon: 'fa-route' },
            { key: 'kitchen', label: 'Kitchen', icon: 'fa-kitchen-set' },
            { key: 'bedroom01', label: 'Bedroom 1', icon: 'fa-bed' },
            { key: 'bedroom02', label: 'Bedroom 2', icon: 'fa-bed' },
            { key: 'bedroom03', label: 'Bedroom 3', icon: 'fa-bed' },
        ];

        // Adapt to renamed keys like bedroom01_1/bedroom01_2
        function pickExistingKey(baseKey) {
            var floorMap = SCENES[currentFloor] || {};
            if (floorMap[baseKey]) return baseKey;
            if (baseKey === 'bedroom01') {
                if (floorMap['bedroom01_1']) return 'bedroom01_1';
            }
            if (baseKey === 'bedroom02') {
                if (floorMap['bedroom02_1']) return 'bedroom02_1';
            }
            if (baseKey === 'bedroom03') {
                if (floorMap['bedroom03_1']) return 'bedroom03_1';
            }
            return null;
        }

        entries.forEach(function(item){
            var key = pickExistingKey(item.key) || item.key;
            var exists = SCENES[currentFloor] && SCENES[currentFloor][key];
            if (!exists) return;
            var btn = document.createElement('button');
            btn.setAttribute('data-room', key);
            btn.innerHTML = '<i class="fa-solid ' + item.icon + '"></i> ' + item.label;
            btn.onclick = function(){ switchRoom(key); };
            container.appendChild(btn);
        });
    }

    // Switch to a room on the current floor by SCENES key
    function switchRoom(roomKey) {
        if (!isInitialized || !player) return;
        var floorMap = SCENES[currentFloor];
        if (!floorMap) return;
        var target = floorMap[roomKey];
        if (!target) return;
        setMediaByName(target);
    }
    
    // Custom function to switch specifically to the balcony
    function switchBalcony(floor) {
        if (SCENES[floor] && SCENES[floor].balcony) {
            setMediaByName(SCENES[floor].balcony);
        } else {
            console.warn('Balcony scene not found for floor', floor);
        }
    }


    // Top-right actions
    function goHome() {
        window.location.href = '../../index.html';
    }

    function toggleFullscreen() {
        var el = document.documentElement;
        if (!document.fullscreenElement) {
            if (el.requestFullscreen) el.requestFullscreen();
        } else {
            if (document.exitFullscreen) document.exitFullscreen();
        }
    }

    var audioMuted = false;
    function toggleAudio() {
        audioMuted = !audioMuted;
        var btn = document.getElementById('audioBtn');
        if (audioMuted) {
            if (player && player.getById) player.getById('pauseGlobalAudios')();
            if (btn) btn.innerHTML = '<i class="fa-solid fa-volume-xmark"></i>';
        } else {
            if (player && player.getById) player.getById('resumeGlobalAudios')();
            if (btn) btn.innerHTML = '<i class="fa-solid fa-volume-high"></i>';
        }
    }

    function getRoomFromSceneName(sceneName) {
        if (!sceneName) return 'entrance';
        
        console.log('Analyzing scene name:', sceneName);
        var s = String(sceneName).toLowerCase();

        // ðŸŽ¯ NEW: Perform an exact lookup of the scene name in the SCENES object.
        for (const floorKey in SCENES) {
            if (SCENES.hasOwnProperty(floorKey)) {
                for (const roomKey in SCENES[floorKey]) {
                    const sceneLabel = SCENES[floorKey][roomKey];
                    if (sceneLabel && String(sceneLabel).toLowerCase() === s) {
                        console.log('Exact scene label match found:', roomKey);
                        return roomKey;
                    }
                }
            }
        }
        // ðŸš€ FALLBACK: If no exact match, use the keyword-based heuristic.
        console.log('No exact scene label match found. Falling back to keyword search.');
        
        // **FIXED:** Reordered and corrected keywords
        if (s.includes('balcony')) return 'balcony';
        if (s.includes('bedroom01_toilet')) return 'bedroom1_toilet';
        if (s.includes('bed2_toilet')) return 'bedroom2_toilet';
        if (s.includes('bdroom03_toilet')) return 'bedroom3_toilet';
        if (s.includes('bedroom02 1')) return 'bedroom02_1'; // More specific check
        if (s.includes('bedroom02 2')) return 'bedroom02_2'; // More specific check
        if (s.includes('bedroom03 01')) return 'bedroom03_1'; // More specific check
        if (s.includes('bedroom03 02')) return 'bedroom03_2'; // More specific check
        if (s.includes('bedroom02')) return 'bedroom02';
        if (s.includes('bedroom01')) return 'bedroom01';
        if (s.includes('kitchen')) return 'kitchen';
        if (s.includes('passage')) return 'passage';
        if (s.includes('hall')) return 'hall';
        if (s.includes('entrance')) return 'entrance';
        
        console.log('No room match found for:', sceneName, '- defaulting to entrance');
        return 'entrance';
    }
    
    // New: resolve room key by scanning SCENES by exact label match
    function getRoomKeyFromSceneLabel(sceneLabel) {
        if (!sceneLabel) return null;
        var labelLower = String(sceneLabel).toLowerCase();
        for (var floorKey in SCENES) {
            var rooms = SCENES[floorKey];
            for (var roomKey in rooms) {
                var candidate = rooms[roomKey];
                if (candidate && String(candidate).toLowerCase() === labelLower) {
                    return roomKey;
                }
            }
        }
        // Fallback to heuristic mapping if exact label not found
        var heuristic = getRoomFromSceneName(sceneLabel);
        return heuristic || null;
    }

    // New: resolve floor by scanning SCENES by exact label match (fallback to token search)
    function getFloorFromSceneLabel(sceneLabel) {
        if (!sceneLabel) return currentFloor;
        var labelLower = String(sceneLabel).toLowerCase();
        for (var floorKey in SCENES) {
            var rooms = SCENES[floorKey];
            for (var roomKey in rooms) {
                var candidate = rooms[roomKey];
                if (candidate && String(candidate).toLowerCase() === labelLower) {
                    return floorKey;
                }
            }
        }
        // Fallback to token-based detection
        return getFloorFromSceneName(sceneLabel);
    }

    function getFloorFromSceneName(sceneName) {
        if (!sceneName) return currentFloor;
        var s = sceneName.toLowerCase();
        
        // Check for floor indicators in the scene name
        if (s.includes('33rd')) return '33rd';
        if (s.includes('25th')) return '25th';
        if (s.includes('23rd')) return '23rd';
        if (s.includes('17th')) return '17th';
        
        // If no floor indicator found, return current floor
        return currentFloor;
    }

    function highlightActiveFloorButton(activeFloor) {
        var buttons = document.querySelectorAll('#floorNav button[data-floor]');
        buttons.forEach(function (btn) {
            var btnFloor = btn.getAttribute('data-floor');
            if (btnFloor === activeFloor) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });
    }

    function setupTracking() {
        if (!player) return;
        console.log('Setting up scene tracking...');

        // Bind to PanoramaPlayListItem 'begin' events
        player.bindOnObjectsOf('PanoramaPlayListItem', 'begin', function (e) {
            // Skip events that don't have proper scene data
            if (!e.data) {
                console.log("Skipping event without data");
                return;
            }

            // Wait a bit for the scene to fully load
            setTimeout(function() {
                var sceneName = getCurrentSceneName();
                if (sceneName && sceneName !== 'begin' && sceneName !== '') {
                    console.log("=== SCENE CHANGE EVENT ===");
                    console.log("Raw scene name:", sceneName);

                    var newRoom = getRoomKeyFromSceneLabel(sceneName);
                    var newFloor = getFloorFromSceneLabel(sceneName);

                    console.log("Detected room:", newRoom);
                    console.log("Detected floor:", newFloor);
                    console.log("Previous state - Floor:", currentFloor, "Room:", currentRoom);

                    // Update tracking state
                    currentRoom = newRoom;
                    
                    if (newFloor !== currentFloor) {
                        currentFloor = newFloor;
                        highlightActiveFloorButton(currentFloor);
                        console.log("Floor changed to:", currentFloor);
                    }

                    console.log("NEW STATE -> Floor:", currentFloor, "Room:", currentRoom);
                    console.log("========================");
                    
                    // Save the new state
                    saveSceneState();
                    
                    // Update room indicator
                    updateCurrentRoomIndicator();
                } else {
                    console.log("Scene name not ready yet, skipping update");
                }
            }, 100); // Small delay to ensure scene is loaded
        }, player, true);

        console.log('Scene tracking setup complete');
        
        // Also bind to stateChange events as a backup
        player.bind('stateChange', function(e) {
            if (e.name === 'mediaChanged') {
                setTimeout(function() {
                    var sceneName = getCurrentSceneName();
                    if (sceneName && sceneName !== 'begin' && sceneName !== '') {
                        console.log("=== STATE CHANGE EVENT (mediaChanged) ===");
                        console.log("Scene name:", sceneName);
                        
                        var newRoom = getRoomKeyFromSceneLabel(sceneName);
                        var newFloor = getFloorFromSceneLabel(sceneName);
                        
                        console.log("Detected room:", newRoom);
                        console.log("Detected floor:", newFloor);
                        
                        // Update tracking state
                        currentRoom = newRoom;
                        if (newFloor !== currentFloor) {
                            currentFloor = newFloor;
                            highlightActiveFloorButton(currentFloor);
                        }
                        
                        console.log("NEW STATE -> Floor:", currentFloor, "Room:", currentRoom);
                        console.log("========================");
                        
                        // Save the new state
                        saveSceneState();
                        
                        // Update room indicator
                        updateCurrentRoomIndicator();
                    }
                }, 200);
            }
        }, player, true);
        
        // Initialize floor navigation state
        setTimeout(function() {
            updateTracking();
            highlightActiveFloorButton(currentFloor);
        }, 1000);
        
        // Set up periodic scene checking
        setInterval(function() {
            if (isInitialized && player) {
                var sceneName = getCurrentSceneName();
                if (sceneName && sceneName !== 'begin' && sceneName !== '') {
                    var roomType = getRoomKeyFromSceneLabel(sceneName);
                    var floorType = getFloorFromSceneLabel(sceneName);
                    
                    // Only update if something actually changed
                    if (roomType !== currentRoom || floorType !== currentFloor) {
                        console.log('Periodic check detected change:');
                        console.log('  Room:', currentRoom, '->', roomType);
                        console.log('  Floor:', currentFloor, '->', floorType);
                        
                        currentRoom = roomType;
                        currentFloor = floorType;
                        
                        highlightActiveFloorButton(currentFloor);
                        saveSceneState();
                        updateCurrentRoomIndicator();
                    }
                }
            }
        }, 3000); // Check every 3 seconds
    }

    function getCurrentSceneName() {
        if (!player) return null;
        try {
            // Try multiple methods to get the current scene name
            
            // Method 1: Try to get from rootPlayer
            var rootPlayer = getRootPlayer();
            if (rootPlayer) {
                try {
                    var currentMedia = rootPlayer.get('currentMedia');
                    if (currentMedia) {
                        // Prefer label (public identifier in script.js)
                        var label = currentMedia.get('label');
                        if (label && label !== 'begin' && label !== '' && label !== 'undefined') {
                            console.log('Method 1 - RootPlayer currentMedia label:', label);
                            return label;
                        }
                        // Fallback to name if label missing
                        var sceneName = currentMedia.get('name');
                        if (sceneName && sceneName !== 'begin' && sceneName !== '' && sceneName !== 'undefined') {
                            console.log('Method 1 - RootPlayer currentMedia name:', sceneName);
                            return sceneName;
                        }
                    }
                } catch (e) {
                    console.log('Method 1 failed:', e);
                }
            }
            
            // Method 2: Try to get from PlayList
            var playLists = player.getByClassName('PlayList');
            console.log('Found playLists:', playLists.length);
            
            for (var i = 0; i < playLists.length; i++) {
                var selectedIndex = playLists[i].get('selectedIndex');
                console.log('PlayList', i, 'selectedIndex:', selectedIndex);
                
                if (selectedIndex !== -1) {
                    var items = playLists[i].get('items');
                    console.log('PlayList', i, 'items count:', items ? items.length : 'undefined');
                    
                    if (items && items[selectedIndex]) {
                        var item = items[selectedIndex];
                        var media = item.get('media');
                        console.log('PlayList', i, 'item media:', media);
                        
                        if (media) {
                            // Prefer label
                            var label2 = media.get('label');
                            if (label2 && label2 !== 'begin' && label2 !== '' && label2 !== 'undefined') {
                                console.log('Method 2 - PlayList item label:', label2);
                                return label2;
                            }
                            var sceneName = media.get('name');
                            console.log('PlayList', i, 'scene name:', sceneName);
                            
                            // Filter out invalid scene names
                            if (sceneName && sceneName !== 'begin' && sceneName !== '' && sceneName !== 'undefined') {
                                console.log('Method 2 - PlayList item:', sceneName);
                                return sceneName;
                            } else {
                                console.log('Scene name filtered out:', sceneName);
                            }
                        }
                    }
                }
            }
            
            // Method 3 disabled to avoid stale fallbacks that force a specific room
            
        } catch (e) {
            console.warn('Error getting current scene name:', e);
        }
        console.log('No valid scene name found, returning null');
        return null;
    }

    function updateTracking() {
        var sceneName = getCurrentSceneName();
        if (!sceneName) return;

        var room = getRoomKeyFromSceneLabel(sceneName);
        var floor = getFloorFromSceneLabel(sceneName);

        currentRoom = room;
        if (floor !== currentFloor) {
            currentFloor = floor;
            highlightActiveFloorButton(currentFloor);
        }

        console.log("Tracking updated -> Floor:", currentFloor, "Room:", currentRoom);
    }

    /* ---------------------- 3DVista Bootstrapping ---------------------- */

    function loadTour() {
        if (player) return;

        var beginFunc = function (event) {
            if (event.name == 'begin') {
                var camera = event.data.source.get('camera');
                if (camera && camera.get('initialSequence') && camera.get('initialSequence').get('movements').length > 0) return;
            }
            if (event.sourceClassName == "MediaAudio") return;

            isInitialized = true;

            player.unbind('preloadMediaShow', beginFunc, player, true);
            player.unbindOnObjectsOf('PanoramaPlayListItem', 'begin', beginFunc, player, true);
            player.unbind('stateChange', beginFunc, player, true);
            window.parent.postMessage("tourLoaded", '*');

            disposePreloader();
            onVirtualTourLoaded();
        };

        var settings = new TDV.PlayerSettings();
        settings.set(TDV.PlayerSettings.CONTAINER, document.getElementById('viewer'));
        settings.set(TDV.PlayerSettings.SCRIPT_URL, 'script.js?v=1755676325278');
        settings.set(TDV.PlayerSettings.WEBVR_POLYFILL_URL, 'lib/WebVRPolyfill.js?v=1755676325278');
        settings.set(TDV.PlayerSettings.HLS_URL, 'lib/Hls.js?v=1755676325278');
        settings.set(TDV.PlayerSettings.QUERY_STRING_PARAMETERS, 'v=1755676325278');

        window.tdvplayer = player = TDV.PlayerAPI.create(settings);

        player.bind('preloadMediaShow', beginFunc, player, true);
        player.bind('stateChange', beginFunc, player, true);
        player.bindOnObjectsOf('PanoramaPlayListItem', 'begin', beginFunc, player, true);

        player.bindOnObject('rootPlayer', 'start', function (e) {
            var queryDict = {};
            location.search.substr(1).split("&").forEach(function (item) {
                var k = item.split("=")[0], v = decodeURIComponent(item.split("=")[1]);
                queryDict[k] = v
            });
            var item;
            if ("media-index" in queryDict) {
                item = setMediaByIndex(parseInt(queryDict["media-index"]) - 1);
            } else if ("media-name" in queryDict) {
                item = setMediaByName(queryDict["media-name"]);
            } else {
                item = setMediaByIndex(0);
            }
            if (item != undefined && "trigger-overlay-name" in queryDict) {
                triggerOverlayByName(item, queryDict["trigger-overlay-name"], "trigger-overlay-event" in queryDict ? queryDict["trigger-overlay-event"] : "click");
            }

            player.getById('rootPlayer').bind('tourEnded', function () {
                onVirtualTourEnded();
            }, player, true);

            // Setup tracking after player is ready
            setupTracking();
            
            // Handle floor and room parameters for direct navigation
            if ("floor" in queryDict && "room" in queryDict) {
                var targetFloor = queryDict["floor"];
                var targetRoom = queryDict["room"];
                if (SCENES[targetFloor] && SCENES[targetFloor][targetRoom]) {
                    setTimeout(function() {
                        currentFloor = targetFloor;
                        currentRoom = targetRoom;
                        var targetScene = SCENES[targetFloor][targetRoom];
                        console.log('Direct navigation to:', targetFloor, targetRoom, targetScene);
                        setMediaByName(targetScene);
                        highlightActiveFloorButton(targetFloor);
                    }, 1000);
                }
            }
        }, player, false);

        window.addEventListener('message', function (e) {
            var action = e.data;
            if (action == 'pauseTour' || action == 'resumeTour') {
                this[action].apply(this);
            }
        });
    }

    function pauseTour() {
        isPaused = true;
        if (!isInitialized) return;

        var playLists = player.getByClassName('PlayList');
        for (var i = 0, count = playLists.length; i < count; i++) {
            var playList = playLists[i];
            var index = playList.get('selectedIndex');
            if (index != -1) {
                var item = playList.get('items')[index];
                var itemPlayer = item.get('player');
                if (itemPlayer && itemPlayer.pause) {
                    playersPlayingTmp.push(itemPlayer);
                    itemPlayer.pause();
                }
            }
        }
        player.getById('pauseGlobalAudios')();
    }

    function resumeTour() {
        isPaused = false;
        if (!isInitialized) return;

        while (playersPlayingTmp.length) {
            var viewer = playersPlayingTmp.pop();
            viewer.play();
        }
        player.getById('resumeGlobalAudios')();
    }

    function onVirtualTourLoaded() {
        console.log('Virtual tour loaded successfully');
        if (isPaused) pauseTour();
        
        // Initialize floor navigation after tour is loaded
        setTimeout(function() {
            console.log('Initializing floor navigation...');
            
            // Try to load saved state first
            if (!loadSceneState()) {
                updateTracking();
            }
            
            highlightActiveFloorButton(currentFloor);
            console.log('Floor navigation initialized. Current floor:', currentFloor, 'Current room:', currentRoom);
            
            // Setup keyboard shortcuts
            setupKeyboardShortcuts();
            
            // Show initial room indicator
            updateCurrentRoomIndicator();

            // Build bottom room bar
            buildRoomNavBar();
        }, 2000);
    }

    function onVirtualTourEnded() {}

    function getRootPlayer() {
        return window.tdvplayer !== undefined ? window.tdvplayer.getById('rootPlayer') : undefined;
    }
    
    function setMediaByIndex(index) {
        var rootPlayer = getRootPlayer();
        if (rootPlayer !== undefined) {
            return rootPlayer.setMainMediaByIndex(index);
        }
    }
    
    function setMediaByName(name) {
        console.log('Setting media by name:', name);
        var rootPlayer = getRootPlayer();
        if (rootPlayer !== undefined) {
            return rootPlayer.setMainMediaByName(name);
        }
    }

    function triggerOverlayByName(item, name, eventName) {
        var rootPlayer = getRootPlayer();
        if (rootPlayer !== undefined) {
            item.bind('begin', function (e) {
                item.unbind('begin', arguments.callee, this);
                var overlay = rootPlayer.getPanoramaOverlayByName(item.get('media'), name);
                if (overlay) rootPlayer.triggerOverlay(overlay, eventName);
            }, rootPlayer);
        }
    }

    function showPreloader() {
        var el = document.getElementById('preloadContainer');
        if (el) el.style.opacity = 1;
    }
    
    function disposePreloader() {
        var el = document.getElementById('preloadContainer');
        if (!el) return;
        var transitionEndName = (function () {
            var d = document.createElement('div'),
                t = {
                    transition: 'transitionend',
                    OTransition: 'otransitionend',
                    MozTransition: 'transitionend',
                    WebkitTransition: 'webkitTransitionEnd'
                };
            for (var k in t) {
                if (d.style[k] !== undefined) return t[k];
            }
        })();
        if (transitionEndName) {
            el.addEventListener(transitionEndName, hide, false);
            el.style.opacity = 0;
            setTimeout(hide, 500);
        } else {
            hide();
        }

        function hide() {
            el.style.visibility = 'hidden';
            el.style.display = 'none';
        }
    }

    function onBodyClick() {
        document.body.removeEventListener("click", onBodyClick);
        document.body.removeEventListener("touchend", onBodyClick);
        loadTour();
    }

    function onLoad() {
        if (/AppleWebKit/.test(navigator.userAgent) && /Mobile\/\w+/.test(navigator.userAgent)) {
            var inIFrame = false;
            try {
                inIFrame = (window.self !== window.top);
            } catch (e) {
                inIFrame = true;
            }
            if (!inIFrame) {
                var onResize = function () {
                    [0, 250, 1000, 2000].forEach(function (delay) {
                        setTimeout(function () {
                            var viewer = document.querySelector('#viewer');
                            var scale = window.innerWidth / document.documentElement.clientWidth;
                            var width = document.documentElement.clientWidth;
                            var height = Math.round(window.innerHeight / scale);
                            viewer.style.width = width + 'px';
                            viewer.style.height = height + 'px';
                            viewer.style.left = Math.round((window.innerWidth - width) * 0.5) + 'px';
                            viewer.style.top = Math.round((window.innerHeight - height) * 0.5) + 'px';
                            viewer.style.transform = 'scale(' + scale + ', ' + scale + ')';
                            window.scrollTo(0, 0);
                        }, delay);
                    });
                };
                window.addEventListener('resize', onResize);
                onResize();
            }
        }
        if (isOVRWeb()) {
            showPreloader();
            loadTour();
            return;
        }
        showPreloader();
        loadTour();
    }

    function playVideo(video) {
        function isSafariDesktopV11orGreater() {
            return /^((?!chrome|android|crios|ipad|iphone).)*safari/i.test(navigator.userAgent) && parseFloat(/Version\/([0-9]+\.[0-9]+)/i.exec(navigator.userAgent)[1]) >= 11;
        }
        function detectUserAction() {
            var onVideoClick = function (e) {
                if (video.paused) {
                    video.play();
                }
                video.muted = false;
                e.stopPropagation();
                e.stopImmediatePropagation();
                e.preventDefault();
                video.removeEventListener('click', onVideoClick);
                video.removeEventListener('touchend', onVideoClick);
            };
            video.addEventListener("click", onVideoClick);
            video.addEventListener("touchend", onVideoClick);
        }
        if (isSafariDesktopV11orGreater()) {
            video.muted = true;
            video.play();
        } else {
            var canPlay = true;
            var promise = video.play();
            if (promise) {
                promise.catch(function () {
                    video.muted = true;
                    video.play();
                    detectUserAction();
                });
            } else {
                canPlay = false;
            }
            if (!canPlay || video.muted) {
                detectUserAction();
            }
        }
    }

    function isOVRWeb() {
        return window.location.hash.substring(1).split('&').indexOf('ovrweb') > -1;
    }

    function toggleAudio() {
        const audio = document.getElementById("background-audio");
        const audioBtn = document.getElementById("audioBtn");

        if (audio.muted) {
            audio.muted = false;
            audio.play();
            audioBtn.innerHTML = '<i class="fa-solid fa-volume-high"></i>';
        } else {
            audio.muted = true;
            audio.pause();
            audioBtn.innerHTML = '<i class="fa-solid fa-volume-xmark"></i>';
        }
    }

    // Orientation check
        function checkOrientation() {
            const overlay = document.getElementById("rotateOverlay");
            if (window.innerHeight > window.innerWidth && /Mobi|Android/i.test(navigator.userAgent)) {
                overlay.style.display = "flex";
            } else {
                overlay.style.display = "none";
            }
        }

        window.addEventListener("resize", checkOrientation);
        window.addEventListener("orientationchange", checkOrientation);
        window.addEventListener("load", checkOrientation);
</script>

</head>

<body onload="onLoad()">
    <audio id="background-audio" loop muted>
        <source src="/assets/audio/audio.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
    <div id="rotateOverlay">
        <i class="fa-solid fa-mobile-screen-button"></i>
        <p>Please rotate your device<br>for the best experience</p>
    </div>
    <div id="preloadContainer" style="background-color:rgba(255,255,255,1)">
        <div style="z-index: 4; position: absolute; left: 0%; top: 50%; width: 100.00%; height: 10.00%">
            <div style="text-align:left; color:#000;">
                <div style="text-align:center;">
                    <span
                        style="letter-spacing:0vmin;color:#777777;font-size:1.39vmin;font-family:Arial, Helvetica, sans-serif;">
                        Loading virtual tour. Please wait...
                    </span>
                </div>
                <p style="margin:0; line-height:1.02vmin;">
                    <br
                        style="letter-spacing:0vmin;color:#000000;font-size:1.02vmin;font-family:Arial, Helvetica, sans-serif;" />
                </p>
            </div>
        </div>
    </div>

    <div id="viewer"></div>

    <div id="topActions">
        <button onclick="goHome()" title="Home">
            <i class="fa-solid fa-home"></i>
        </button>
        <button title="Fullscreen" onclick="toggleFullscreen()"><i class="fa-solid fa-expand"></i></button>
        <button class="utility-btn" id="audioBtn" onclick="toggleAudio()">
            <i class="fa-solid fa-volume-xmark"></i>
        </button>
    </div>

    <div id="floorNav">
        <button data-floor="17th" onclick="switchFloor('17th')">17F</button>
        <!-- <button data-floor="23rd" onclick="switchFloor('23rd')">23F</button> -->
        <button data-floor="25th" onclick="switchFloor('25th')">25F</button>
        <button data-floor="33rd" onclick="switchFloor('33rd')">33F</button>
    </div>

    <div id="roomNav"></div>

    </body>

</html>